<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Python DB Manager</title>
    <style>
        body { font-family: sans-serif; max-width: 500px; margin: 40px auto; padding: 20px; }
        .row { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #eee; }
        button { cursor: pointer; }
        .del-btn { color: red; border: 1px solid red; background: none; border-radius: 4px; }
        input { width: 70%; padding: 8px; }
    </script>
</head>
<body>

    <h2>Message Database</h2>
    
    <div style="margin-bottom: 20px;">
        <input type="text" id="msgInput" placeholder="Enter message...">
        <button onclick="addRow()">Add Row</button>
    </div>

    <div id="messageList">Loading messages...</div>

    <script>
        const API_URL = "https://my-python-cloudflare-api.markku-lab.workers.dev";

        // 1. READ rows
        async function loadRows() {
            const res = await fetch(API_URL);
            const data = await res.json();
            const container = document.getElementById('messageList');
            container.innerHTML = data.map(row => `
                <div class="row">
                    <span>${row.content}</span>
                    <button class="del-btn" onclick="deleteRow(${row.id})">Delete</button>
                </div>
            `).join('');
        }

        // 2. CREATE row
        async function addRow() {
            const input = document.getElementById('msgInput');
            await fetch(API_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ message: input.value })
            });
            input.value = '';
            loadRows(); // Refresh list
        }

        // 3. DELETE row
        async function deleteRow(id) {
            await fetch(API_URL, {
                method: 'DELETE',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ id: id })
            });
            loadRows(); // Refresh list
        }

        // Initial Load
        loadRows();
    </script>
</body>
</html>
